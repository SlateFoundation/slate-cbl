<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">Ext.define(&#39;Slate.cbl.Util&#39;, function() {

    function _sortNewestDemonstrationFirstFn(a, b) {
        return a.Demonstrated &gt; b.Demonstrated ? -1 : a.Demonstrated &lt; b.Demonstrated ? 1 : 0;
    }

    function _sortOldestDemonstrationFirstFn(a, b) {
        if (a.Demonstrated &gt; b.Demonstrated) {
            return 1;
        } else if (a.Demonstrated &lt; b.Demonstrated) {
            return -1;
        }

        return a.ID &gt; b.ID ? 1 : -1;
    }

    function _sortGreatestLevelFirstFn(a, b) {
        a = parseInt(a, 10);
        b = parseInt(b, 10);
        return a &gt; b ? -1 : a &lt; b ? 1 : 0;
    }

    return {
        singleton : true,

        padArray: function(array, length, value, prefix) {
            array = array || [];

            while (array.length &lt; length) {
                array[prefix ? &#39;unshift&#39; : &#39;push&#39;](typeof value == &#39;undefined&#39; ? {} : value);
            }

            return array;
        },

        sortDemonstrations: function sortDemonstrations(demonstrations, limit) {
            demonstrations = Ext.isArray(demonstrations) ? demonstrations : [];

            var len = demonstrations.length,
                x = 0,
                i = 0,
                demo,
                sortedDemonstrations = {},
                levelsSorted,
                demos,
                demosLen,
                displayDemonstrations = [],
                scored = [],
                missed = [];

            // If no limit is specified, sort all demonstrations
            limit = isNaN(limit) ? len : limit;

            // Separate demonstrations by level
            for (x = 0; len &gt; x; x++) {
                demo = demonstrations[x];

                // skip placeholder blocks
                if (demo !== true) {
                    sortedDemonstrations[demo.DemonstratedLevel] = sortedDemonstrations[demo.DemonstratedLevel] || [];
                    sortedDemonstrations[demo.DemonstratedLevel].push(demo);
                }
            }

            // Sort the levels of demonstrations observed from greatest to least
            levelsSorted = Object.keys(sortedDemonstrations).sort(_sortGreatestLevelFirstFn);

            // Loop over demonstrations starting with the highest levels
            levelLoop:
            for (x = 0, len = levelsSorted.length; len &gt; x; x++) {
                // Sort demonstrations for x-level by date (newest first)
                demos = sortedDemonstrations[levelsSorted[x]].sort(_sortNewestDemonstrationFirstFn);

                // Get limit-number of demonstrations
                for (i = 0, demosLen = demos.length; demosLen &gt; i; i++) {
                    displayDemonstrations.push(demos[i]);
                    if (--limit === 0) {
                        // Break out early
                        break levelLoop;
                    }
                }
            }

            // Split up scored and missed demonstrations while keeping order by date (oldest first)
            displayDemonstrations.sort(_sortOldestDemonstrationFirstFn);

            for (x = 0, len = displayDemonstrations.length; x &lt; len; x++) {
                demo = displayDemonstrations[x];
                if (demo.DemonstratedLevel &gt; 0) {
                    scored.push(demo);
                } else {
                    missed.push(demo);
                }
            }

            // Scored demonstrations go on the left, missed demonstrations go on the right
            return scored.concat(missed);
        },

<span id='global-method-syncRowHeights'>        /**
</span>         * @protected
         * Synchronizes the heights of two sets of table rows by setting the height of both to the max of the two
         *
         * @param {Ext.dom.CompositeElement/Ext.dom.CompositeElementLite} table1Rows
         * @param {Ext.dom.CompositeElement/Ext.dom.CompositeElementLite} table2Rows
         */
        syncRowHeights: function(table1Rows, table2Rows) {

            Ext.batchLayouts(function() {
                var table1RowHeights = [],
                    table2RowHeights = [],
                    rowCount, rowIndex, maxHeight;

                rowCount = table1Rows.getCount();

                if (table2Rows.getCount() != rowCount) {
                    Ext.Logger.warn(&#39;tables\&#39; row counts don\&#39;t match&#39;);
                }

                // read all the row height in batch first for both tables
                for (rowIndex = 0; rowIndex &lt; rowCount; rowIndex++) {
                    table1RowHeights.push(table1Rows.item(rowIndex).getHeight());
                    table2RowHeights.push(table2Rows.item(rowIndex).getHeight());
                }

                // write all the max row heights
                for (rowIndex = 0; rowIndex &lt; rowCount; rowIndex++) {
                    maxHeight = Math.max(table1RowHeights[rowIndex], table2RowHeights[rowIndex]);
                    table1Rows.item(rowIndex).select(&#39;td, th&#39;).setHeight(maxHeight);
                    table2Rows.item(rowIndex).select(&#39;td, th&#39;).setHeight(maxHeight);
                }
            });

        }
    };
});</pre>
</body>
</html>
